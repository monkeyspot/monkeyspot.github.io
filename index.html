<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #6782B4;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #B1BFD8;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            margin-bottom: 1em;
            background: #485461; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #485461, #28313B);
            background: -moz-linear-gradient(right, #485461, #28313B);
            background: -o-linear-gradient(right, #485461, #28313B);
            background: linear-gradient(to left, #485461, #28313B);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }
    </style>
</head>

<body class="staticrypt-body">
<div class="staticrypt-page">
    <div class="staticrypt-form">
        <div class="staticrypt-instructions">
            <img src="https://raw.githubusercontent.com/monkeyspot/monkeyspot.github.io/master/icon.png">
            <p class="staticrypt-title">tools.monkeyspot.io</p>
            <p></p>
        </div>

        <hr class="staticrypt-hr">

        <form id="staticrypt-form" action="#" method="post">
            <input id="staticrypt-password"
                   type="password"
                   name="password"
                   placeholder="passphrase"
                   autofocus/>

            <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
        </form>
    </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js" integrity="sha384-lp4k1VRKPU9eBnPePjnJ9M2RF3i7PC30gXs70+elCVfgwLwx1tv5+ctxdtwxqZa7" crossorigin="anonymous"></script>

<script>

    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     */
    var keySize = 256;
    var iterations = 1000;
    function decrypt (encryptedMsg, pass) {
        var salt = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32));
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(32, 32))
        var encrypted = encryptedMsg.substring(64);

        var key = CryptoJS.PBKDF2(pass, salt, {
            keySize: keySize/32,
            iterations: iterations
        });

        var decrypted = CryptoJS.AES.decrypt(encrypted, key, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
        return decrypted;
    }

    document.getElementById('staticrypt-form').addEventListener('submit', function(e) {
        e.preventDefault();

        var passphrase = document.getElementById('staticrypt-password').value,
            encryptedMsg = '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',
            encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(passphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            alert('Bad passphrase!');
            return;
        }

        var plainHTML = decrypt(encryptedHTML, passphrase);

        document.write(plainHTML);
        document.close();
    });
</script>
</body>
</html>
